<!DOCTYPE html>
<html lang="en">
<head>
  <meta charSet="utf-8"/>
  <title>NovaHunt.ai</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>

  <style>
    * { box-sizing: border-box; }
    html, body, #__next { height: 100%; }
    body { margin: 0; font-family: "Inter", system-ui, -apple-system, sans-serif; background: #f9fafb; color: #111827; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
    .page-root { display: flex; flex-direction: column; align-items: center; justify-content: flex-start; min-height: 100vh; padding: 80px 20px 56px; text-align: center; } /* Padding for header */
    .brand { font-size: 72px; font-weight: 800; margin: 0 0 8px; line-height: 1; }
    .lead { font-weight: 500; font-size: 28px; color: #4b5563; max-width: 920px; margin: 0 0 18px; }
    .domain-form { width: 100%; max-width: 1080px; display: flex; flex-direction: column; align-items: center; }
    input[type="text"] { width: 100%; max-width: 920px; padding: 28px 26px; font-size: 24px; border: 2px solid #d1d5db; border-radius: 28px; margin-bottom: 10px; outline: none; box-shadow: 0 14px 40px rgba(2,6,23,.06); }
    .hint { margin: 8px 0 16px; color: #6b7280; font-size: 15px; text-align: center; max-width: 860px; }
    .actions-row { display: flex; gap: 16px; align-items: center; justify-content: center; flex-wrap: wrap; margin-top: 8px; }
    .cta { display: inline-flex; align-items: center; justify-content: center; gap: 8px; border-radius: 16px; padding: 16px 36px; font-weight: 800; font-size: 18px; text-decoration: none; cursor: pointer; border: none; background: linear-gradient(180deg, #007bff, #06f); color: #fff; box-shadow: 0 32px 80px rgba(0,102,255,.22), 0 10px 30px rgba(0,102,255,.12); }
    .results-wrap { width: 100%; max-width: 920px; margin-top: 22px; display: flex; flex-direction: column; align-items: center; }
    .result { background: white; border-radius: 16px; padding: 18px; box-shadow: 0 18px 44px rgba(15,23,42,.06); margin-bottom: 16px; width: 100%; }
    @media (max-width: 920px) { .domain-form { max-width: 96%; } input[type="text"] { max-width: 92%; padding: 22px 18px; font-size: 20px; } }
    @media (max-width: 768px) { .brand { font-size: 48px; } .lead { font-size: 22px; } .cta { padding: 12px 20px; font-size: 16px; } }
  </style>
</head>
<body>
  <div id="__next">
    <header style="position: fixed; top: 0; left: 0; right: 0; background: white; z-index: 40; padding: 12px 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); display: flex; justify-content: flex-end; align-items: center;">
      <div id="auth-container"></div>
    </header>

    <main class="page-root">
      <h1 class="brand">NovaHunt.ai</h1>
      <p class="lead">Find business emails instantly. Enter a company domain and get professional contacts.</p>
      <form class="domain-form" id="search-form">
        <input id="domainInput" name="domain" type="text" inputMode="url" placeholder="Enter domain, e.g. coca-cola.com" aria-label="Company domain" autoComplete="off" value=""/>
        <div class="hint">Try a domain (e.g. coca-cola.com) to do a quick search.</div>
        <div class="actions-row">
          <button type="submit" class="cta primary">Take us for a test drive</button>
          <a href="/checkout" role="button" class="cta primary">Choose Your Plan</a>
        </div>
      </form>
      <div class="results-wrap" id="results"></div>
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const supabase = Supabase.createClient('https://YOUR-PROJECT.supabase.co', 'YOUR-PUBLIC-ANON-KEY'); // Replace with your keys

    const hunterApiKey = 'YOUR_HUNTER_API_KEY'; // Replace with your Hunter.io key ($49 plan)

    const authContainer = document.getElementById('auth-container');
    const searchForm = document.getElementById('search-form');
    const results = document.getElementById('results');

    async function updateAuth() {
      const { data: { user } } = await supabase.auth.getUser();
      authContainer.innerHTML = '';
      if (user) {
        const div = document.createElement('div');
        div.style = 'display: flex; align-items: center; gap: 16px;';
        div.innerHTML = `<span>${user.email}</span><button style="background:#dc2626;color:white;padding:8px 16px;border:none;border-radius:8px;cursor:pointer;">Sign Out</button>`;
        div.querySelector('button').onclick = async () => { await supabase.auth.signOut(); updateAuth(); };
        authContainer.appendChild(div);
      } else {
        const btn = document.createElement('button');
        btn.textContent = 'Sign Up / Sign In';
        btn.style = 'background:#2563eb;color:white;padding:12px 24px;border:none;border-radius:12px;font-weight:700;font-size:16px;cursor:pointer;';
        btn.onclick = showAuthModal;
        authContainer.appendChild(btn);
      }
    }

    function showAuthModal() {
      const modal = document.createElement('div');
      modal.style = 'position:fixed;inset:0;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;padding:16px;z-index:100;';
      modal.innerHTML = `
        <div style="width:100%;max-width:400px;background:white;border-radius:16px;padding:32px;">
          <h2 style="text-align:center;font-size:24px;font-weight:800;margin-bottom:24px;" id="title">Create Account</h2>
          <form id="form" style="display:flex;flex-direction:column;gap:16px;">
            <input type="email" id="email" placeholder="Email address" required style="padding:12px 16px;border:2px solid #d1d5db;border-radius:12px;font-size:16px;" />
            <input type="password" id="password" placeholder="Password (min. 6 characters)" required minlength="6" style="padding:12px 16px;border:2px solid #d1d5db;border-radius:12px;font-size:16px;" />
            <button type="submit" id="submit" style="padding:14px;background:#2563eb;color:white;border:none;border-radius:12px;font-weight:700;font-size:18px;">Sign Up</button>
          </form>
          <p id="msg" style="text-align:center;margin-top:16px;"></p>
          <p style="text-align:center;margin-top:24px;">
            Already have an account? <button id="toggle" style="color:#2563eb;font-weight:700;background:none;border:none;cursor:pointer;">Sign In</button>
          </p>
          <button id="close" style="margin-top:24px;color:#6b7280;background:none;border:none;width:100%;cursor:pointer;">Close</button>
        </div>
      `;
      document.body.appendChild(modal);

      let isSignUp = true;
      const title = modal.querySelector('#title');
      const submit = modal.querySelector('#submit');
      const toggle = modal.querySelector('#toggle');
      const msg = modal.querySelector('#msg');

      toggle.onclick = () => {
        isSignUp = !isSignUp;
        title.textContent = isSignUp ? 'Create Account' : 'Welcome Back';
        submit.textContent = isSignUp ? 'Sign Up' : 'Sign In';
      };

      modal.querySelector('#form').onsubmit = async (e) => {
        e.preventDefault();
        const email = modal.querySelector('#email').value;
        const password = modal.querySelector('#password').value;
        submit.disabled = true;
        submit.textContent = 'Loading...';

        const { error } = isSignUp ? await supabase.auth.signUp({ email, password }) : await supabase.auth.signInWithPassword({ email, password });
        if (error) {
          msg.textContent = error.message;
          msg.style.color = 'red';
        } else {
          msg.textContent = isSignUp ? 'Check your email for confirmation!' : 'Welcome back!';
          msg.style.color = 'green';
          setTimeout(() => { document.body.removeChild(modal); updateAuth(); }, 1500);
        }
        submit.disabled = false;
        submit.textContent = isSignUp ? 'Sign Up' : 'Sign In';
      };

      modal.querySelector('#close').onclick = () => document.body.removeChild(modal);
      modal.onclick = (e) => { if (e.target === modal) document.body.removeChild(modal); };
    }

    // Search with Hunter.io
    searchForm.onsubmit = async (e) => {
      e.preventDefault();
      const domain = document.getElementById('domainInput').value;
      if (!domain) return;

      const { data: { user } } = await supabase.auth.getUser();
      if (!user) return alert('Please sign in to search.');

      // Check credits
      const { data: credits, error } = await supabase.from('user_credits').select('*').eq('user_id', user.id).single();
      if (credits.searches_used >= credits.search_limit) return alert('Search limit reached. Upgrade plan.');
      if (error) return alert('Error checking credits.');

      results.innerHTML = '<p>Searching...</p>';

      const url = `https://api.hunter.io/v2/domain-search?domain=${domain}&api_key=${hunterApiKey}`;
      const response = await fetch(url);
      const data = await response.json();

      results.innerHTML = '';
      if (data.data.emails) {
        data.data.emails.forEach((email) => {
          const div = document.createElement('div');
          div.className = 'result';
          div.innerHTML = `<p>Email: ${email.value}</p><p>Confidence: ${email.confidence}%</p>`;
          results.appendChild(div);
        });
        // Update credits
        await supabase.from('user_credits').update({ searches_used: credits.searches_used + 1 }).eq('user_id', user.id);
      } else {
        results.innerHTML = '<p>No emails found.</p>';
      }
    };

    updateAuth();
    supabase.auth.onAuthStateChange(updateAuth);
  </script>
</body>
</html>
